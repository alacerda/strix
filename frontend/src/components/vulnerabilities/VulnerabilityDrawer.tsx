'use client';

import type { Vulnerability } from '@/types';

interface VulnerabilityDrawerProps {
  vulnerability: Vulnerability | null;
  onClose: () => void;
}

export function VulnerabilityDrawer({ vulnerability, onClose }: VulnerabilityDrawerProps) {
  if (!vulnerability) return null;

  const getSeverityClass = (severity: string) => {
    switch (severity) {
      case 'critical':
        return 'bg-critical text-white';
      case 'high':
        return 'bg-high text-white';
      case 'medium':
        return 'bg-medium text-white';
      case 'low':
        return 'bg-low text-white';
      case 'info':
        return 'bg-info text-white';
      default:
        return 'bg-text-muted text-white';
    }
  };

  return (
    <>
      <div
        className="fixed inset-0 bg-black/70 z-[1000]"
        onClick={onClose}
      />
      <div
        className="fixed right-0 top-0 bottom-0 w-[600px] bg-bg-secondary z-[1001] shadow-2xl flex flex-col"
        onClick={(e) => e.stopPropagation()}
      >
        <div className="p-4 border-b border-border-color flex justify-between items-start">
          <div className="flex-1">
            <div className="text-xl font-semibold mb-2">{vulnerability.title}</div>
            <div className="flex gap-4 text-sm">
              <div>
                <span className="text-text-muted">ID: </span>
                <span className="font-mono text-text-primary">{vulnerability.id}</span>
              </div>
              <div>
                <span className="text-text-muted">Severity: </span>
                <span className={`px-2 py-1 rounded text-xs font-semibold ${getSeverityClass(vulnerability.severity)}`}>
                  {vulnerability.severity}
                </span>
              </div>
              {vulnerability.timestamp && (
                <div>
                  <span className="text-text-muted">Date: </span>
                  <span className="text-text-primary">
                    {new Date(vulnerability.timestamp).toLocaleString()}
                  </span>
                </div>
              )}
            </div>
          </div>
          <button
            onClick={onClose}
            className="bg-transparent border-none text-text-secondary text-2xl cursor-pointer hover:text-text-primary ml-4"
            aria-label="Close"
          >
            Ã—
          </button>
        </div>
        <div className="flex-1 overflow-y-auto p-4">
          <div className="mb-4">
            <div className="text-sm font-semibold mb-2 text-text-primary">Details</div>
            <div className="text-sm text-text-secondary whitespace-pre-wrap leading-relaxed">
              {vulnerability.content}
            </div>
          </div>
        </div>
      </div>
    </>
  );
}

